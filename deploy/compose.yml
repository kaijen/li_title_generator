name: ${COMPOSE_PROJECT_NAME:-title-image-prod}

# Produktions-Compose-Datei – versioniert, keine manuelle Kopie nötig.
# Anpassungen (Netzwerke, Labels, Limits) über ein lokales Overlay vornehmen:
#
#   docker compose -f compose.yml -f compose.override.yml up -d
#
# Instanzspezifische Werte (IMAGE_TAG, TRAEFIK_HOST, …) in .env eintragen:
#   cp .env.sample .env

services:
  title-image-prod:
    image: ${IMAGE_NAME:-ghcr.io/kaijen/title-image}:${IMAGE_TAG:-latest}
    container_name: ${CONTAINER_NAME:-title-image}
    hostname: ${CONTAINER_NAME:-title-image}
    ports:
      - "${PORT:-8000}:8000"
    volumes:
      - ./api_keys.json:/config/api_keys.json:ro
      - font-cache:/fonts-cache
    environment:
      - API_KEYS_FILE=/config/api_keys.json
      - FONT_CACHE_DIR=/fonts-cache
      - HOST=${HOST:-0.0.0.0}
      - ALLOW_UNAUTHENTICATED=${ALLOW_UNAUTHENTICATED:-false}
    restart: unless-stopped

volumes:
  font-cache:
